<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ö–∏–Ω–æ–∑–∞–ª</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É Kinobox -->
    <script src="https://kinobox.tv/kinobox.min.js"></script>
    <style>
        body { 
            background: #0f0f0f; 
            margin: 0; 
            overflow: hidden; 
            font-family: -apple-system, sans-serif;
            color: #fff;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            padding: 15px;
            background: #151515;
            text-align: center;
            font-weight: bold;
            font-size: 16px;
            border-bottom: 1px solid #333;
            flex-shrink: 0;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –ø–ª–µ–µ—Ä–∞ –¥–æ–ª–∂–µ–Ω –∑–∞–Ω–∏–º–∞—Ç—å –≤—Å–µ –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –º–µ—Å—Ç–æ */
        .kinobox_player {
            flex-grow: 1;
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ */
        .error-msg {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #888;
        }
    </style>
</head>
<body>
    <div class="header" id="movie-title">
        –ó–∞–≥—Ä—É–∑–∫–∞...
    </div>

    <!-- –°—é–¥–∞ –≤—Å—Ç—Ä–æ–∏—Ç—Å—è –ø–ª–µ–µ—Ä -->
    <div class="kinobox_player" id="kinobox-wrapper"></div>
    
    <div class="error-msg" id="not-found">
        üòï –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –ø–ª–µ–µ—Ä.<br>–ü–æ–ø—Ä–æ–±—É–π –¥—Ä—É–≥–æ–π —Ñ–∏–ª—å–º.
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.enableClosingConfirmation();

        // 1. –ü–æ–ª—É—á–∞–µ–º ID —Å –ö–∏–Ω–æ–ø–æ–∏—Å–∫–∞ –∏–∑ —Å—Å—ã–ª–∫–∏
        const urlParams = new URLSearchParams(window.location.search);
        // Kinobox —É–º–µ–µ—Ç –∏—Å–∫–∞—Ç—å –∏ –ø–æ kinopoisk ID, –∏ –ø–æ imdb ID
        const kpId = urlParams.get('id'); 
        const name = urlParams.get('name');

        if (name) {
            document.getElementById('movie-title').innerText = name;
        }

        // 2. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º Kinobox
        if (kpId) {
            new Kinobox('.kinobox_player', {
                search: {
                    kinopoisk: kpId // –ü–µ—Ä–µ–¥–∞–µ–º ID
                },
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞
                menu: {
                    default: 'menu_list',
                    mobile: 'menu_list',
                    format: '{N} :: {T} ({Q})'
                },
                players: {
                    // –ó–¥–µ—Å—å –º—ã –≥–æ–≤–æ—Ä–∏–º —Å–∫—Ä–∏–ø—Ç—É, –≥–¥–µ –∏—Å–∫–∞—Ç—å
                    // –û–Ω —Å–∞–º –ø–µ—Ä–µ–±–µ—Ä–µ—Ç Alloha, Kodik, VideoCDN –∏ –≤—ã–±–µ—Ä–µ—Ç —Ä–∞–±–æ—á–∏–π
                    alloha: {enable: true, position: 1},
                    kodik: {enable: true, position: 2}, // –ê–Ω–∏–º–µ
                    videocdn: {enable: true, position: 3},
                    collaps: {enable: true, position: 4},
                    ashdi: {enable: true, position: 5}
                },
                notFoundMessage: '–í–∏–¥–µ–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.'
            }).init();
        } else {
            document.getElementById('not-found').innerText = "–û—à–∏–±–∫–∞: ID —Ñ–∏–ª—å–º–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω –≤ —Å—Å—ã–ª–∫–µ";
            document.getElementById('not-found').style.display = 'block';
        }
    </script>
</body>
</html>
